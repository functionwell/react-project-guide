# 你最终将从JavaScript项目中学到的10件事

[原文地址](https://blog.usejournal.com/10-things-you-will-eventually-learn-about-javascript-projects-efd7646b958a)

**JavaScript是一项冒险。** 在各行各业从事近十年的业余和专业的开发之后，我相信每个人都会同意这一点。

前端项目给我们程序员在灵活性以及创造空间上提供了许多自由的选择——但相应的，这也需要一定的知识量，计划性，和自我责任感。

经历了jQuery，require.js，Angular，React，ExtJs，以及一大堆其它我可能记不得（或者不想记得）的项目——我见证了2018的前端难以想象的事情。并且我们可能以前都做过！

但是总有一些 **通用的模式使得即使是最不协调的项目也能以某种方式管理得当。** 下面你将看到这些模式中最重要的10条——由个人经验总结，肯定有点想当然，但我相信大部分有经验的开发者会赞同。这些模式为使用 **任何框架，任何方法，任何团队规模** 的项目都提供了稳固的基础——减少了对文档的需求，对重构的需求，以及开发人员眼中流出的泪水。

我希望你能从中学到一些新的、有用的东西，并用他们创造出令人惊奇的东西。

## 1. 分而治之

我们大多数人都曾经听过，但很多人似乎都低估了这条规则。CommonJS，Webpack，以及Node赋予我们将大妈拆分成多个文件的能力——但我们为什么要关心这一点？

**一致性原则。** 将你的项目分成单个导出的文件，当代码库不断增长时，这会使搜索和依赖管理 **异常简单** 。给每个文件命名为它唯一导出的东西使得文件更加 **直观** ，在遍历这个架构时也不会给大脑带来负担。

**可管理性。**  将每个导出分离到单独的文件中，使得必要时你可以快速得移动它，并 **促进解耦<sup>1</sup>** 。当你的应用程序的不同部分需要辅助函数时，你可以简单地创建一个 `/share` 目录，将它拖到里面——使得代码的其它部分可以访问它。

## 2. 让事情变得显而易见

**每个变量，每个函数，每个文件——好好花点时间命名他们就像给你的孩子命名一样。** 你今天把这个变量叫做"x"节约了你0.3秒的时间，但一个月后你会花上2天的时间搞明白它意味着什么，重构的时候甚至花上4天。**提前考虑起来，不要害怕名字太长。**

**避免代码破解以及那些让你觉得可以拿着去申请MIT的东西。** 你的解决方案可能的确是聪明而复杂的——在未来的某个时候，你或是你团队里的其他人，会认同这一点，然后花费大量时间试图弄清楚代码中发生了什么。 **专注于将事情变得简单，不需要文档或者注释<sup>2</sup>。** 

## 3. 处理魔法数字和字符串

与命名类似——不要在代码中使用魔法数字或者字符串，无论他们多么诱人。 **不管带来的价值是多小甚至微不足道，都应该把它放到一个有意义的名称的变量中，并移到作用域的顶部。** 

大多数情况下， **你放置在代码中的显式值都将在其它地方重用。** 将他们放入变量中会减少代码重复，使得调整更加容易，也赋予了这些值一定的意义。

## 4. 与嵌套作斗争

如果你的代码超过120个字符，超过500行，或者 **你的if语句深度达到3层——尽你所能拆分它。**

你可以将深度嵌套的if语句拆分成独立的函数、`Promise`，或者`Observable`来处理条件的复杂性。如果你使用大量异步调用，`async/await` 可以显著简化你的代码。

## 5. Configure hard

如果你的应用使用 **全局变量，API端点，功能切换，或者第三方凭证<sup>3</sup>** ——把他们放进一个 **独立的配置文件中**。

有很多软件包可以帮助管理web和node中的配置，比如[`comfig`](https://www.npmjs.com/package/config)。在某些时候， **你的应用将在服务器上和本地都可用于开发。** 提前创建配置文件比在后续阶段创建更容易，并且允许你调整这些环境下的行为方式，他们应该使用哪些凭证，哪些功能是可用的等等。

## 6. 框架是用来提供帮助的

很多时候你会发现使用框架的原因是 **有人熟悉这个框架，或者这个框架比较流行**。

花点时间思考一下你的项目是否需要一个框架，以及应该是哪个框架。 **你的网站或者应用即便是用Github上拥有100000星星数的框架创建的，终端用户也一点也不关心。** 根据经验，我将框架和库分为：
- **React** ：当你需要 **完全控制** 架构和构建时，但仅适用于使用组件构建的 **webapp** 。 **React生态系统需要事先花些时间并且需要大量的准备工作。** React回报很多，但前提是你知道自己在做什么。
- **Angular / VueJS / Ember** : 当你需要一个 **快速完成而且可靠** 的 **webapp** 时，作为交换允许一个大黑匣子而不是一个架构。 **这些框架为你做了许多——消除了架构规划的优点和缺点。** 与React的自由相比，他们严格的结构也会允许更多的错误。
- **jQuery / lodash / or similar<sup>4</sup>** : 当你需要 **快速**完成一个 **网页**，**并且你可以留出一些KB**。这些可以显著缩短开发时间，但要小心，因为他们允许你编写不可维护的代码——使用他们作为辅助库，而不是作为基础框架。
- **Vanilla / No framework** : 可用于网页和webapp，当你可以花费大量时间进行开发和规划时。当你的项目进行一些 **试验** 时，纯JavaScript是一个不错的选择——引入WebGL，Workers，深层优化，或者浏览器动画——你最终可以创建出 **自己的框架** 。结合转换器，它也可以作为jQuery的更好更轻量的替代品。

仅将次列表视为建议—— **花些时间确定哪个框架（如果有的话）最适合你的项目**。

## 7. 编写测试——除非他是原型

单元测试。冒烟测试。e2e测试。完成性检查。除非你的项目只是一个很快会被重写的原型，否则请编写测试。 **随着复杂性的增加，你的代码库将变得难以维护和控制——测试在这方面将会帮到你。**

在将来的某个时候，你会遇到一个bug，看着一望无云的蓝天，你会感谢过去的你写下了测试——因为在你添加了全新的功能之后，**你从未意识到有多少东西在后台悄然崩溃了**。

## 8. 使用版本控制

无论它是一个原型，还是全面的企业级webapp，或者是一个小小的娱乐项目—— **从你写下第一行代码的那一刻起，就使用`git`或其他版本控制工具**。每天提交，使用分支，学习如何合并，解决冲突，以及返回到之前的提交。**写有意义的提交消息**。

**版本控制允许你穿越时间**，保存零碎的东西，查看过去引入的改动。如果你从本文中学到了一件事，那就应该是 **学习版本控制的基础知识并每天使用它**。为什么？因为即使你忽略了其它部分，并且在途中意外出错，**使用版本控制你仍可以修复它**——没有版本控制，你通常注定要重新开始。

## 9. 负责任地管理状态

**找到一个用于状态管理的模式或库，并像你的生活依赖于它一样坚持下去——因为在某些时候可能就是这样。**

作为前端开发人员，我们通常 **只面临两个重大挑战——显示数据和存储数据**。随着时间推移存储数据变得难以维护，因为很容易就忽略它——直到几个月后你的项目几乎无法维护。

**存储数据，即状态管理**，是棘手的。我们的应用通常必须使 **客户在其屏幕上看到的内容**，与 **服务器在数据库中存储的** 保持一致。我们的目标是不在这之中添加任何的复杂性——在我们的JavaScript结构中。组件应该传递相同的数据集，同步用户所做的更改，并对服务器上的改动做出响应。我们如何解决这个问题？

- 由于是一个非常开发的生态系统，`React`有很多解决方案——用于Flux架构的`Redux`，用于基于observable的`Mobx`。每个都有其优点和缺点—— **在使用之前确保你学习并理解这些库的基础知识**。
- `Angular`，`Ember`，以及`VueJS`基于 **Observable**的概念提供自己的内置状态管理解决方案。虽然没有必要，但还有其他库<sup>5</sup>，比如`ngRx`，`Akita`和`Vuex`。
- 对于任何其他框架或Vanilla JavaScript，你可以使用`Redux`，`Mobx`，或者你自己的状态管理解决方案。主要目标是确保 **整个应用程序具有相同的真实来源——这可以使一个服务，一个库，或者一个可观察的简单状态**。

## 10. 质疑趋势

最后，**倾听并向社区学习——但要研究并质疑你所阅读的所有内容，每篇评论，猫（作者）在Medium上的每一篇长篇大论，以及任何对代码的反馈**。对新想法持开放态度——正如那些时不时出现在我们前端生态系统中的新想法一样——但要 **确保你不是为了随大流而随大流** ——这已经导致了相当多的项目被遗忘。

**用一个较老的，成熟的框架编写的项目通常比一个用两个框架编写的项目更好，更稳定——只是因为新的框架出来了。** 虽然新的趋势可能会稍微改善应用程序和开发性能，但它几乎不会影响一致性。坚持你的选择以保持可维护性并在必要时进行调整——但仅在必要时进行调整。

**好了，在此刻我想感谢你的阅读，并希望在评论中听到你的意见和故事！** 如上所述，这些是我在JavaScript和前端开发过程中遇到的非常重要的经历——只是我们日复一日遇到的挑战海洋中的一小部分！

如果你想添加一些东西，赞同，或者指出我完全错误的地方——**在评论区告诉我，或者在Twitter上ping我[@thefrontendcat](https://twitter.com/thefrontendcat)！**

再一次，谢谢你，

希望你发现其中一处或多处对你有价值！

TheFrontendCat @ [InstantFrontend.io](https://instantfrontend.io/)

以下是文章中的一些解释和详细注释：

<sup>1</sup> **解耦** 是一种实践，其中代码的每个部分都是完全独立的，并且任何依赖关系都通过参数或注入传递。 它可能并不总是能实现，但是它可以随着时间的推移使测试和可维护性更容易。

<sup>2</sup> 你通常可以使用 **npm** 上开源的软件包来 **简化** 问题。花点时间浏览下 **npmjs.com** ——也许已经有一个包可以解决你的问题了？

<sup>3</sup> 切记 **永远不要提交** 您的凭据。 如果您使用的是Jenkins，CircleCI或类似设置 - 在构建上下文中将凭据设置为环境变量。 如果仅在本地部署，请将凭据存储在安全位置。

<sup>4</sup> 由于大多数功能现在可以使用ECMAScript标准函数创建，因此围绕jQuery，lodash和类似库存在一些盲目的恨意——但如果您熟悉jQuery体系结构，并且您想要创建的只是一个网页， 在我看来你应该坚持下去 - 我发现使用这些库来实现更简单的项目和原型速度更快，更清晰。

<sup>5</sup> 考虑到你也可以使用Redux，因为它与框架无关，但从长远来看，由于严格的架构和基于Observable的模型，它可能会带来很多复杂性。

